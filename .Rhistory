labs(title="",
x ="Word", y = "Number of words")
###PARWISE COUNT###
# prikazuju se samo tri riječi prve
sukob_words %>%
select(idClanka, word, sukob) %>%
pairwise_count(word, idClanka, sort = TRUE) -> sukob_word_pairs
# sukob_words %>%
#  select(sukob, word) %>%
#  mutate(sukob = case_when(sukob == "trad" ~ 1,
#            sukob == "kont" ~ 2,
#            sukob == "kont2" ~3,
#            sukob == "repo" ~ 4)) %>%
#  mutate(sukob = as.integer(sukob)) %>% #str()
#  pairwise_count(word, sukob, sort = TRUE) -> sukob_word_pairs_sukob
sukob_rijeci <- c("prijedlog", "prosvjed", "prijetnje", "napad" ) # šteta
uber_rijeci <- c("posao", "zarada", "koristi", "cijena", "plaćanje")
korpus_rijeci <- c("zakon", "nelegalno", "politika", "ministar","turizam", "sigurnost")
##PARWISE COUNT SA IZABRANIM RIJEČIMA##
sukob_word_pairs %>%
filter(item2 %in% sukob_rijeci) %>%
group_by(item2) %>%
slice(1:8) %>%
ungroup() %>%
slice(c(-2,-4,-6,-11,-19,-24,-28)) %>%
mutate(item1 = recode(item1,
'prijevoza' = "transport",
'taksisti' = "taxi drivers",
"uber" = "uber",
"taksista" = "taxi drivers",
"vozila"  = "vehicles",
"zakona" = "law"  ,
"kuna"  = "kuna" ,
"prijevoz" = "transport",
"zagrebu" = "zagreb",
"prometa" = "traffic" ,
"vozaea" = "drivers",
"uberu" = "uber" ,
"usluga" = "service",
"mora" = "enforce",
"može" = "can",
"prijevoza" = "traffic",
"uberu" = "uber",
"smatraju" = "consider",
"protiv" = "against",
"kažu" = "claim",
"prijevozu" = "traffic",
"tržište" = "market",
"imaju" = "possesion",
"grada" = "city",
"hrvatske" = "Croatia",
"mogu" = "possibility",
"promet" = "traffic",
"infrastrukture" = "infrastructure")) %>%
mutate(item2 = recode(item2,
'napad' = "Attack",
'prijedlog' = "Suggestion",
"prijetnje" = "Threats",
"prosvjed"  = "Demonstrations" )) %>%
mutate(item2 = reorder(item2, n)) %>%
ggplot(aes(item1, n)) +
geom_bar(stat = "identity") +
theme_economist() +
facet_wrap(~ item2, scales = "free") +
coord_flip() +
labs(title="",
x ="Word", y = "Number of words")
sukob_words %>%
mutate(Datum = floor_date(dejt, "quarter")) %>%
group_by(Datum) %>%
count(word) %>%
mutate(gn = sum(n)) %>%
filter(word %in% sukob_rijeci) %>%
mutate(word = recode(word,
'napad' = "Attack",
'prijetnje' = "Threats",
"prijedlog" = "Suggestion",
"prosvjed"  = "Demonstrations")) %>%
ggplot(., aes(Datum, n / gn)) +
geom_point() +
geom_smooth() +
facet_wrap(~ word, scales = "free_y") +
scale_y_continuous(labels = scales::percent_format()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title="",
x ="Date", y = "% of total words(quarterly)") +
theme_economist()
##SENTIMENT_FUNKCIJA
izracunaj_sentiment <- function(dataset) {
dataset %>%
inner_join( Crosentilex_sve, by = "word") %>%
mutate(word = gsub("\\d+", NA, word)) %>%
mutate(word = gsub("^[a-zA-Z]$", NA, word)) %>%
filter(!is.na(word)) %>%
select(word, brija, dejt, sentiment) %>%
unique() %>%
spread(. , brija, sentiment) %>%
mutate(sentiment = POZ - NEG) %>%
select(word, dejt, sentiment) %>%
group_by(word) %>%
mutate(count = n()) %>%
arrange(desc(count)) %>%
mutate( score = sentiment*count) %>%
ungroup() %>%
group_by(dejt) %>%
arrange(desc(dejt)) -> sm
sm %>%
select(dejt, score) %>%
group_by(Datum = floor_date(dejt, "quarter")) %>%
summarise(Tjedni_sent = sum(score, na.rm = TRUE)) %>%
ggplot(., aes(Datum, Tjedni_sent)) +
geom_bar(stat = "identity")+
labs(title="",
x ="Date", y = "Sentiment Score") -> gg_sentiment_kroz_vrijeme_qv
#grid.arrange(gg_sentiment_kroz_vrijeme_qv, nrow = 2 )
}
fullCorpus <- izracunaj_sentiment(korpus_words)
# fullCorpus #+ ggtitle("Graph X: Sentiment through time (quarterly) for full text corpus")
sm %>%
select(dejt, score) %>%
group_by(Datum = floor_date(dejt, "quarter")) %>%
summarise(Tjedni_sent = sum(score, na.rm = TRUE)) %>%
ggplot(., aes(Datum, Tjedni_sent)) +
geom_bar(stat = "identity")+
labs(title="",
x ="Date", y = "Sentiment Score") +
theme_economist()-> gg_sentiment_kroz_vrijeme_qv
izracunaj_sentiment <- function(dataset) {
dataset %>%
inner_join( Crosentilex_sve, by = "word") %>%
mutate(word = gsub("\\d+", NA, word)) %>%
mutate(word = gsub("^[a-zA-Z]$", NA, word)) %>%
filter(!is.na(word)) %>%
select(word, brija, dejt, sentiment) %>%
unique() %>%
spread(. , brija, sentiment) %>%
mutate(sentiment = POZ - NEG) %>%
select(word, dejt, sentiment) %>%
group_by(word) %>%
mutate(count = n()) %>%
arrange(desc(count)) %>%
mutate( score = sentiment*count) %>%
ungroup() %>%
group_by(dejt) %>%
arrange(desc(dejt)) -> sm
sm %>%
select(dejt, score) %>%
group_by(Datum = floor_date(dejt, "quarter")) %>%
summarise(Tjedni_sent = sum(score, na.rm = TRUE)) %>%
ggplot(., aes(Datum, Tjedni_sent)) +
geom_bar(stat = "identity")+
labs(title="",
x ="Date", y = "Sentiment Score") +
theme_economist()-> gg_sentiment_kroz_vrijeme_qv
#grid.arrange(gg_sentiment_kroz_vrijeme_qv, nrow = 2 )
}
sukobCorpus <- izracunaj_sentiment(sukob_words)
sukobCorpus #+ ggtitle("Graph X: Sentiment through time (quarterly) for conflict text corpus")
uberCorpus <- izracunaj_sentiment(uber_words)
uberCorpus #+ ggtitle("Graph X: Sentiment through time (quarterly) for Uber text corpus")
korpus_word_pairs %>%
filter(item2 %in% rijeci_korelacija) %>%
group_by(item2) %>%
slice(1:8) %>%
ungroup()  %>% # View()
slice(c(-1,-3,-9,-16,-18,-19,-23,-26,-27,-25,-33,-42,-43)) %>%
mutate(item1 = recode(item1,
'prijevoza' = "transport",
'taksisti' = "taxi drivers",
"uber" = "uber",
"taksista" = "taxi drivers",
"vozila"  = "vehicles",
"zakona" = "law"  ,
"kuna"  = "kuna" ,
"prijevoz" = "transport",
"zagrebu" = "zagreb",
"prometa" = "traffic" ,
"vozaea" = "drivers",
"uberu" = "uber" ,
"usluga" = "service",
"mora" = "must",
"može" = "can",
"prijevoza" = "traffic",
"uberu" = "uber",
"smatraju" = "consider",
"protiv" = "against",
"kažu" = "claim",
"cestovnom" = "road traffic",
"prijevozu" = "traffic",
"tržište" = "market")) %>%
mutate(item2 = recode(item2,
'zarada' = "Income",
'sigurnost' = "Safety",
'zakon' = "Law",
"uber" = "Uber",
"vozila"  = "Vehicles",
"zakona" = "Law",
"dozvola"  = "Taxi licence" ,
"konkurencija" = "Competition",
"nelegalno" = "Illegal",
"cestovnom" = "road transport")) %>%
mutate(item2 = reorder(item2, n)) %>%
ggplot(aes(item1, n)) +
geom_bar(stat = "identity") +
facet_wrap(~ item2, scales = "free") +
coord_flip() +
labs(title="",
x ="Word", y = "Number of words") + theme_economist()
sukob_words %>%
select(idClanka, word, sukob) %>%
pairwise_count(word, idClanka, sort = TRUE) -> sukob_word_pairs
sukob_words %>%
select(idClanka, word, sukob) %>%
pairwise_count(word, idClanka, sort = TRUE) -> sukob_word_pairs
sukob_rijeci <- c("prijedlog", "prosvjed", "prijetnje", "napad" ) # šteta
uber_rijeci <- c("posao", "zarada", "koristi", "cijena", "plaćanje")
korpus_rijeci <- c("zakon", "nelegalno", "politika", "ministar","turizam", "sigurnost")
sukob_word_pairs %>%
filter(item2 %in% sukob_rijeci) %>%
group_by(item2) %>%
slice(1:8) %>%
ungroup() %>%
slice(c(-2,-4,-6,-11,-19,-24,-28)) %>%
mutate(item1 = recode(item1,
'prijevoza' = "transport",
'taksisti' = "taxi drivers",
"uber" = "uber",
"taksista" = "taxi drivers",
"vozila"  = "vehicles",
"zakona" = "law"  ,
"kuna"  = "kuna" ,
"prijevoz" = "transport",
"zagrebu" = "zagreb",
"prometa" = "traffic" ,
"vozaea" = "drivers",
"uberu" = "uber" ,
"usluga" = "service",
"mora" = "enforce",
"može" = "can",
"prijevoza" = "traffic",
"uberu" = "uber",
"smatraju" = "consider",
"protiv" = "against",
"kažu" = "claim",
"prijevozu" = "traffic",
"tržište" = "market",
"imaju" = "possesion",
"grada" = "city",
"hrvatske" = "Croatia",
"mogu" = "possibility",
"promet" = "traffic",
"infrastrukture" = "infrastructure")) %>%
mutate(item2 = recode(item2,
'napad' = "Attack",
'prijedlog' = "Suggestion",
"prijetnje" = "Threats",
"prosvjed"  = "Demonstrations" )) %>%
mutate(item2 = reorder(item2, n)) %>%
ggplot(aes(item1, n)) +
geom_bar(stat = "identity") +
theme_economist() +
facet_wrap(~ item2, scales = "free") +
coord_flip() +
labs(title="",
x ="Word", y = "Number of words")
###PARWISE COUNT###
# prikazuju se samo tri riječi prve
sukob_words %>%
select(idClanka, word, sukob) %>%
pairwise_count(word, idClanka, sort = TRUE) -> sukob_word_pairs
# sukob_words %>%
#  select(sukob, word) %>%
#  mutate(sukob = case_when(sukob == "trad" ~ 1,
#            sukob == "kont" ~ 2,
#            sukob == "kont2" ~3,
#            sukob == "repo" ~ 4)) %>%
#  mutate(sukob = as.integer(sukob)) %>% #str()
#  pairwise_count(word, sukob, sort = TRUE) -> sukob_word_pairs_sukob
sukob_rijeci <- c("prijedlog", "prosvjed", "prijetnje", "napad" ) # šteta
uber_rijeci <- c("posao", "zarada", "koristi", "cijena", "plaćanje")
korpus_rijeci <- c("zakon", "nelegalno", "politika", "ministar","turizam", "sigurnost")
##PARWISE COUNT SA IZABRANIM RIJEČIMA##
sukob_word_pairs %>%
filter(item2 %in% sukob_rijeci) %>%
group_by(item2) %>%
slice(1:8) %>%
ungroup() %>%
slice(c(-2,-4,-6,-11,-19,-24,-28)) %>%
mutate(item1 = recode(item1,
'prijevoza' = "transport",
'taksisti' = "taxi drivers",
"uber" = "uber",
"taksista" = "taxi drivers",
"vozila"  = "vehicles",
"zakona" = "law"  ,
"kuna"  = "kuna" ,
"prijevoz" = "transport",
"zagrebu" = "zagreb",
"prometa" = "traffic" ,
"vozaea" = "drivers",
"uberu" = "uber" ,
"usluga" = "service",
"mora" = "enforce",
"može" = "can",
"prijevoza" = "traffic",
"uberu" = "uber",
"smatraju" = "consider",
"protiv" = "against",
"kažu" = "claim",
"prijevozu" = "traffic",
"tržište" = "market",
"imaju" = "possesion",
"grada" = "city",
"hrvatske" = "Croatia",
"mogu" = "possibility",
"promet" = "traffic",
"infrastrukture" = "infrastructure")) %>%
mutate(item2 = recode(item2,
'napad' = "Attack",
'prijedlog' = "Suggestion",
"prijetnje" = "Threats",
"prosvjed"  = "Demonstrations" )) %>%
mutate(item2 = reorder(item2, n)) %>%
ggplot(aes(item1, n)) +
geom_bar(stat = "identity") +
theme_economist() +
facet_wrap(~ item2, scales = "free") +
coord_flip() +
labs(title="",
x ="Word", y = "Number of words")
sukob
idf_sukob
idf_sukob %>%
mutate(sukob = case_when(sukob == "trad" ~ "c",
sukob == "repo" ~ "d",
sukob == "kont" ~ "e",
sukob == "kont" ~ "f")) %>%
mutate(word = factor(word, levels = rev(unique(word)))) %>%
group_by(sukob) %>%
select(sukob, word, tf_idf) %>%
arrange(desc(tf_idf)) %>%
do(head(., n = 5)) %>%
filter(!word %in% c("tremac", "davor", "nekih", "ovdje",
"franković", "grabar", "kitarović",
"trebao", "martina", "ivan", "ribić", "pilko"))   %>%
mutate(word = recode(word,
'dojam' = "impression",
'korisne' = "usefull",
"ispitanih" = "surveyed",
"odgovorilo" = "answered",
"policijskoj"  = "police",
"prijetnjama" = "threats"  ,
"regulativa"  = "regulation" ,
"verbalnom" = "verbal",
"žale" = "complain",
"napada" = "attack" ,
"dubrovačko" = "dubrovnik",
"nasilja" = "violence" ,
"usluga" = "service",
"opasnost" = "danger",
"partnerima" = "partners",
"pozitivna" = "positive",
"prošlih" = "historic",
"relikt" = "relict",
"štete" = "damage",
"prijedloga" = "proposal",
"naknadu" = "compensation",
"zakone" = "law",
'cestama' = "road",
'provodi' = "implement",
"pismu" = "letter",
"predstavnike" = "representative",
"primjedbi"  = "complaints",
"usluga" = "service"  ,
"ovlasti"  = "authority" ,
"umjesto" = "insteda",
"direktive" = "directives",
"dodatne" = "additional" ,
"dovodi" = "bring",
"interesu" = "interest" ,
'izvješća' = "report",
'mirnim' = "peacefull",
"prekršajni" = "criminal",
"općine" = "county",
"italiji"  = "italy",
"propisano" = "prescribed"  ,
"visoki"  = "high" ,
"usluga" = "service",
"javni" = "public",
"prijedloga" = "suggestion" ,
"optužni" = "indictment",
"prijavu" = "notification" ,
"list" = "paper",
"odbio" = "revoke",
"večernji" = "night",
'inspekcija' = "inspection",
'prijedlog' = "suggestion",
"aplikacija" = "application",
"troškovi" = "costs",
"napad"  = "attack",
"gotovo" = "over"  ,
"automobil"  = "car" ,
"sati" = "hours",
"policiji" = "police",
"potom" = "after" ,
"staklo" = "glass",
"ubacili" = "throw into" ,
"institucijama" = "institutions",
'normalno' = "normal",
'potpredsjednik' = "vice president",
"spontano" = "spontaneous",
"taxija" = "taxi",
"automobilu"  = "car" )) %>%
ggplot(.,aes(reorder(word,tf_idf), tf_idf, fill = sukob)) +
geom_col(show.legend = FALSE) +
theme(axis.text.y = element_text(angle = 30, hjust = 1, size = 8)) +
facet_wrap(~sukob, ncol = 2, scales = "free") +
coord_flip() +
labs(title="",
x ="Word", y = "TF-IDF statistic") +
theme_economist()-> gg_idf_1
gg_idf_1
idf_sukob %>%
mutate(sukob = case_when(sukob == "trad" ~ "c",
sukob == "repo" ~ "d",
sukob == "kont" ~ "e",
sukob == "kont2" ~ "f")) %>%
mutate(word = factor(word, levels = rev(unique(word)))) %>%
group_by(sukob) %>%
select(sukob, word, tf_idf) %>%
arrange(desc(tf_idf)) %>%
do(head(., n = 5)) %>%
filter(!word %in% c("tremac", "davor", "nekih", "ovdje",
"franković", "grabar", "kitarović",
"trebao", "martina", "ivan", "ribić", "pilko"))   %>%
mutate(word = recode(word,
'dojam' = "impression",
'korisne' = "usefull",
"ispitanih" = "surveyed",
"odgovorilo" = "answered",
"policijskoj"  = "police",
"prijetnjama" = "threats"  ,
"regulativa"  = "regulation" ,
"verbalnom" = "verbal",
"žale" = "complain",
"napada" = "attack" ,
"dubrovačko" = "dubrovnik",
"nasilja" = "violence" ,
"usluga" = "service",
"opasnost" = "danger",
"partnerima" = "partners",
"pozitivna" = "positive",
"prošlih" = "historic",
"relikt" = "relict",
"štete" = "damage",
"prijedloga" = "proposal",
"naknadu" = "compensation",
"zakone" = "law",
'cestama' = "road",
'provodi' = "implement",
"pismu" = "letter",
"predstavnike" = "representative",
"primjedbi"  = "complaints",
"usluga" = "service"  ,
"ovlasti"  = "authority" ,
"umjesto" = "insteda",
"direktive" = "directives",
"dodatne" = "additional" ,
"dovodi" = "bring",
"interesu" = "interest" ,
'izvješća' = "report",
'mirnim' = "peacefull",
"prekršajni" = "criminal",
"općine" = "county",
"italiji"  = "italy",
"propisano" = "prescribed"  ,
"visoki"  = "high" ,
"usluga" = "service",
"javni" = "public",
"prijedloga" = "suggestion" ,
"optužni" = "indictment",
"prijavu" = "notification" ,
"list" = "paper",
"odbio" = "revoke",
"večernji" = "night",
'inspekcija' = "inspection",
'prijedlog' = "suggestion",
"aplikacija" = "application",
"troškovi" = "costs",
"napad"  = "attack",
"gotovo" = "over"  ,
"automobil"  = "car" ,
"sati" = "hours",
"policiji" = "police",
"potom" = "after" ,
"staklo" = "glass",
"ubacili" = "throw into" ,
"institucijama" = "institutions",
'normalno' = "normal",
'potpredsjednik' = "vice president",
"spontano" = "spontaneous",
"taxija" = "taxi",
"automobilu"  = "car" )) %>%
ggplot(.,aes(reorder(word,tf_idf), tf_idf, fill = sukob)) +
geom_col(show.legend = FALSE) +
theme(axis.text.y = element_text(angle = 30, hjust = 1, size = 8)) +
facet_wrap(~sukob, ncol = 2, scales = "free") +
coord_flip() +
labs(title="",
x ="Word", y = "TF-IDF statistic") +
theme_economist()-> gg_idf_1
gg_idf_1
